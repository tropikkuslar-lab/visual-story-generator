# Görsel Hikaye Üretici (Visual Story Generator)

Türkçe metinleri yapay zeka destekli görsellere dönüştüren gelişmiş bir hikaye görselleştirme sistemi.

![React](https://img.shields.io/badge/React-18.3-blue)
![TypeScript](https://img.shields.io/badge/TypeScript-5.6-blue)
![Tailwind CSS](https://img.shields.io/badge/Tailwind-3.4-blue)
![Stable Diffusion](https://img.shields.io/badge/Stable%20Diffusion-1.5-green)

## Özellikler

### Temel Özellikler

- **Türkçe Metin Analizi**: Türkçe hikaye metinlerini otomatik olarak analiz eder
- **Sahne Bölümleme**: Metni anlamlı sahnelere ayırır
- **Prompt Oluşturma**: Her sahne için optimize edilmiş İngilizce promptlar üretir
- **Çift Prompt Modu**: "Sadık" (metne bağlı) ve "Yaratıcı" (artistik) prompt seçenekleri
- **Responsive Tasarım**: Mobil ve masaüstü cihazlarla uyumlu arayüz

---

## Gelişmiş Türkçe Dil Analizi

### Deyim ve Mecaz Algılama
Türkçe deyimleri tespit eder ve görsel karşılıklarına dönüştürür:

| Deyim | Görsel Karşılık |
|-------|-----------------|
| "Yüreği ağzına geldi" | Dramatik korku ifadesi, geniş gözler |
| "Gözleri doldu" | Parlak gözyaşları, duygusal bakış |
| "İçi parçalandı" | Parçalanmış cam yansıması, dağılmış parçalar |
| "Ayakları geri geri gitti" | Gerileyen figür, korku dolu duruş |
| "Kanı dondu" | Donmuş ifade, buz mavisi tonlar |
| "Yüzü kireç gibi oldu" | Solgun yüz, beyaz ten |
| "Kalbi küt küt atmak" | Kalp atışı efekti, titreşim |

### Soyut Kavram Görselleştirme
Soyut kavramları somut görsellere dönüştürür:

| Kavram | Görsel |
|--------|--------|
| Özgürlük | Uçan kuşlar, açık gökyüzü |
| Umut | Altın ışık huzmesi, ufukta şafak |
| Korku | Karanlık gölgeler, ürkütücü atmosfer |
| Aşk | Kırmızı kalpler, sıcak renkler |
| Yalnızlık | Tek başına figür, boş mekan |
| Zaman | Saat mekanizması, kum saati |

### Karşıt Kavram Algılama
Metindeki zıtlıkları dramatik görsellere dönüştürür:
- Işık/Karanlık, İyi/Kötü, Aşk/Nefret
- Görsel: İkiye bölünmüş kompozisyon, kontrast aydınlatma

### Metaforik Renk Analizi
Türkçe renk metaforlarını algılar:
- "Kara gün" → Koyu, kasvetli atmosfer
- "Pembe dünya" → Naif, iyimser görünüm
- "Yeşil umut" → Taze, canlı yeşil tonlar

---

## Karmaşık İstek Analizi

### Niyet ve Arzu Tespiti
| Niyet Tipi | Örnek | Görsel |
|------------|-------|--------|
| Arzu | "istiyorum", "özlüyorum" | Uzanan eller, özlem dolu bakış |
| Arayış | "arıyorum", "peşinde" | Yolculuk, keşif atmosferi |
| Bekleme | "bekliyorum", "umuyorum" | Pencereden bakan figür |
| Hatırlama | "hatırladı", "anımsadı" | Bulanık geçmiş görüntüleri |
| Hayal | "hayal ediyorum" | Rüya gibi, sürreal atmosfer |

### Koşullu/Varsayımsal Analiz
- "Keşke..." → Nostaljik, pişmanlık atmosferi
- "Sanki..." → Rüya gibi, belirsiz sınırlar
- "Eğer..." → Yol ayrımı, alternatif gerçeklik
- "Belki..." → Sisli, belirsiz atmosfer

### Zamansal İfade Analizi
| Zaman Tipi | Görsel Efekt |
|------------|--------------|
| Ani | Flaş efekti, keskin geçiş |
| Yavaş | Ağır çekim, motion blur |
| Sürekli | Döngüsel kompozisyon |
| Geçmiş | Sepya tonlar, bulanık kenarlar |
| Gelecek | Parlak, net görüntü |

### Karakter Etkileşimi
- Diyalog → İki figür, konuşma pozu
- Fiziksel temas → Yakın mesafe, dokunuş
- Çatışma → Karşıt pozisyonlar, gerilim
- Vedalaşma → Uzaklaşan figürler
- Koruma → Kucaklayıcı, koruyucu duruş

### Anlatım Perspektifi
| Perspektif | Kamera Yaklaşımı |
|------------|------------------|
| Birinci şahıs (Ben) | POV açısı, öznel görüş |
| İkinci şahıs (Sen) | Doğrudan bakış, yakın |
| Üçüncü şahıs (O) | Gözlemci açısı, sinematik |

### Sembolik Nesne Algılama
| Nesne | Sembolik Anlam |
|-------|----------------|
| Ayna | Kendini yansıtma, iç gözlem |
| Mektup | İletişim, geçmiş bağlantısı |
| Saat | Zaman geçişi, yaşlanma |
| Anahtar | Gizem, çözüm, olasılık |
| Pencere | Dış dünyaya bakış, umut |
| Yol | Yolculuk, seçim, kader |

### Duyusal Detay Algılama
- **Sesler**: Rüzgar, yağmur, müzik → Ses dalgaları, titreşim efektleri
- **Kokular**: Çiçek, kahve, toprak → Buhar, parçacık efektleri
- **Dokular**: Yumuşak, sert, pürüzlü → Detaylı yüzey dokuları

### Mekansal İlişki Analizi
Türkçe mekan edatlarını kompozisyona dönüştürür:
- "üstünde", "altında", "arkasında", "önünde"
- "içinde", "dışında", "yanında", "etrafında"

---

## Tür ve Stil Algılama

### Otomatik Tür Tespiti
| Tür | Tetikleyici Kelimeler | Görsel Stil |
|-----|----------------------|-------------|
| Korku | dehşet, kabus, hayalet, lanet | Karanlık, desatüre, kan kırmızısı |
| Romantik | aşk, öpücük, sevgili | Sıcak pembe, altın saat |
| Bilim Kurgu | uzay, robot, gelecek | Neon, siber, holografik |
| Fantastik | ejderha, büyü, peri | Mistik, büyülü parıltı |
| Aksiyon | saldırdı, patlama, kovalamaca | Yüksek kontrast, dinamik |
| Gerilim | tehlike, takip, gizem | Soğuk tonlar, keskin gölgeler |
| Dram | gözyaşı, ayrılık, kayıp | Doğal, duygusal aydınlatma |
| Tarihi | Osmanlı, savaş, kral | Dönem costümleri, klasik |

### Diyalog Tonu Algılama
| Ton | Görsel Karşılık |
|-----|-----------------|
| Bağırma | Açık ağız, gergin kaslar |
| Fısıltı | Yakın mesafe, gizli bakış |
| Ağlama | Gözyaşları, kırılgan ifade |
| Gülme | Geniş gülümseme, neşeli |
| Tehdit | Sert bakış, baskın duruş |
| Yalvarma | Diz çökmüş, yakarış |

### İlişki Dinamikleri
| İlişki | Görsel Poz |
|--------|-----------|
| Aile | Koruyucu sarılma, nesil bağı |
| Romantik | El ele, yakın mesafe |
| Düşmanlık | Karşıt pozisyonlar, gerilim |
| Dostluk | Omuz omuza, neşeli |
| Mentor | Öğretici duruş, rehberlik |

### Aksiyon Yoğunluğu (1-10)
| Seviye | Görsel Efekt |
|--------|--------------|
| Düşük (1-3) | Statik, sakin kompozisyon |
| Orta (4-6) | Hareket ima eden |
| Yüksek (7-8) | Motion blur, dinamik açı |
| Aşırı (9-10) | Kaos, patlama efektleri |

### Tarihi Dönem Tespiti
| Dönem | Görsel Öğeler |
|-------|---------------|
| Antik Çağ | Yunan sütunları, toga |
| Ortaçağ | Şövalye zırhı, kale |
| Osmanlı | Saray, kavuk, cami |
| Viktorya | Dantel, şapka, mobilya |
| Gelecek | Hologram, neon, uzay |

---

## Görsel Kalite ve Çeşitlilik

### Gelişmiş Kalite Etiketleri
Her stil için optimize edilmiş kalite parametreleri:

| Stil | Kalite Özellikleri |
|------|-------------------|
| Sinematik | Film grain, anamorfik lens, sinematik renk grading |
| Fotogerçekçi | RAW foto, DSLR kalitesi, 35mm film efekti |
| Dijital Sanat | Concept art, Artstation kalitesi, canlı renkler |
| Yağlı Boya | Fırça darbeleri, müze kalitesi, klasik sanat |
| Suluboya | Yumuşak kenarlar, artistik, delikat yıkamalar |
| Anime | Studio kalitesi, canlı anime renkleri |
| Fantastik | Epik fantazi, büyülü atmosfer |

### Çeşitli Kamera Açıları
**Aksiyon Sahneleri:**
- Dutch angle, dinamik perspektif
- Alçak açı kahraman çekimi
- Overhead aksiyon görünümü
- Takip çekimi hareketi

**Diyalog Sahneleri:**
- Over-the-shoulder çekimi
- Orta iki kişilik çekim
- Yakın plan konuşma
- Profil görünümü

**İç Monolog:**
- Aşırı yakın plan gözler
- Yumuşak odaklı portre
- Silüet ışığa karşı
- Yansıma çekimi

**Betimleme:**
- Panoramik manzara
- Kuş bakışı görünümü
- Atmosferik uzun çekim
- Katmanlı derinlik

### Işıklandırma Presetleri

**Zaman Bazlı:**
| Zaman | Işık Özellikleri |
|-------|-----------------|
| Gündüz | Parlak doğal gün ışığı |
| Gece | Ay ışığı, şehir ışıkları, yıldızlar |
| Akşam | Altın saat, mor-pembe gökyüzü |
| Sabah | Şafak kırılması, sabah sisi |

**Tür Bazlı Atmosfer:**
| Tür | Atmosfer |
|-----|----------|
| Korku | Ürkütücü sis, hastalıklı yeşil |
| Romantik | Rüya gibi parıltı, gül pembesi |
| Bilim Kurgu | Neon aydınlatma, holografik |
| Fantazi | Büyülü parçacıklar, mistik aurora |
| Aksiyon | Toz parçacıkları, duman |

### Sanatçı Stil Referansları

| Kategori | Sanatçılar |
|----------|-----------|
| Sinematik | Roger Deakins, Denis Villeneuve, Christopher Nolan |
| Fantazi | Frank Frazetta, Alan Lee, John Howe |
| Dijital Sanat | Craig Mullins, Maciej Kuciara, Sparth |
| Anime | Studio Ghibli, Makoto Shinkai, Ufotable |
| Fotoğraf | Peter Lindbergh, Annie Leibovitz, Steve McCurry |
| Yağlı Boya | Rembrandt, Caravaggio, John Singer Sargent |
| Korku | H.R. Giger, Zdzisław Beksiński, Junji Ito |
| Romantik | Alphonse Mucha, Pre-Raphaelite |

### Gelişmiş Negatif Prompt Sistemi
Tür ve stile göre otomatik optimize edilen negatif promptlar:
- Anatomik hatalar (kötü eller, eksik parmaklar)
- Kalite sorunları (bulanık, pikselleşmiş)
- Stil uyumsuzlukları (anime için fotogerçekçi önleme)
- Tür çelişkileri (korku için parlak renk önleme)

### Çözünürlük ve Kalite Sistemi

#### Kalite Presetleri
| Preset | Açıklama | Çözünürlükler |
|--------|----------|---------------|
| ⚡ Taslak | Hızlı önizleme için | 360p, 480p |
| ✓ Standart | Günlük kullanım için ideal | 720p, 1080p |
| ★ Yüksek | Profesyonel kalite | 1440p |
| ♦ Ultra | Maksimum kalite | 2160p |

#### Çözünürlük Detayları
| Çözünürlük | Boyut | VRAM | Süre |
|------------|-------|------|------|
| 360p | 640x360 | 2GB | ~5s |
| 480p | 854x480 | 3GB | ~8s |
| 720p (HD) | 1280x720 | 4GB | ~15s |
| 1080p (Full HD) | 1920x1080 | 6GB | ~30s |
| 1440p (2K) | 2560x1440 | 8GB | ~60s |
| 2160p (4K) | 3840x2160 | 12GB+ | ~120s |

#### Format Bazlı Hesaplama
Seçilen format (en-boy oranı) otomatik olarak çözünürlük hesaplamasına yansır:
- **16:9** - Sinematik yatay (varsayılan)
- **9:16** - Dikey / Mobil
- **1:1** - Kare
- **4:3** - Klasik
- **21:9** - Ultra geniş

#### Gelişmiş Özellikler
- Görsel hız/kalite göstergesi (progress bar)
- VRAM ve tahmini süre bilgisi
- Yüksek çözünürlük uyarıları
- Kalite badge'leri (renkli göstergeler)

**Not:** Yüksek çözünürlükler daha fazla GPU belleği ve işlem süresi gerektirir.

---

## v3.0 Yeni Özellikler

### Öğrenme Sistemi
- **SQLite Veritabanı**: Tüm üretimler ve geri bildirimler kalıcı olarak saklanır
- **Feedback Sistemi**: 1-5 arası puanlama ve hata kategorileri
- **Öğrenilen Örüntüler**: Başarılı üretimlerin ortak özelliklerini öğrenir
- **Otomatik Optimizasyon**: Scene type + mood + genre kombinasyonları için en iyi ayarları bulur

### Gelişmiş Duygu Analizi
- **13 Duygu Sınıfı**: Sevinç, üzüntü, öfke, korku, şaşkınlık, iğrenme, güven, beklenti, nostalji, umut, çaresizlik, romantizm, nötr
- **Yoğunluk Ölçümü (1-10)**: Her duygunun yoğunluğu hassas olarak ölçülür
- **Olumsuzlama Algılama**: "mutlu değil", "sevmiyorum" gibi ifadeleri doğru yorumlar
- **Bağlam Farkındalığı**: Yoğunluk artırıcı/azaltıcılar: "çok", "aşırı", "biraz", "hafif"
- **Görsel İpuçları**: Her duygu için renk, ışık, atmosfer önerileri

### Güvenlik Katmanı
- **NSFW/Şiddet Filtresi**: Yasaklı içerik otomatik engellenir
- **Path Güvenliği**: Path traversal saldırıları engellenir
- **Rate Limiting**: Dakikada 30 istek sınırı (DDoS koruması)
- **UUID Tabanlı Job ID**: Güvenli ve tahmin edilemez iş kimlikleri
- **CORS Konfigürasyonu**: Production ve development ortamları için ayrı ayarlar

### GPU Stabilite
- **OOM Koruması**: Bellek yetersizliğinde otomatik kurtarma
- **Otomatik Yeniden Deneme**: Küçültülmüş boyutta tekrar deneme
- **VRAM İzleme**: Anlık GPU bellek kullanımı takibi
- **Dinamik Önbellek Temizleme**: Gerektiğinde otomatik cache temizliği
- **Eşzamanlı İş Limiti**: Maksimum 3 paralel üretim

### Prompt Yönetimi
- **Tek Nokta Güçlendirme**: Prompt şişmesini önleyen unified enhancer
- **Öğrenilmiş Eklemeler**: Başarılı üretimlerden öğrenilen prompt eklemeleri
- **Hata Düzeltmeleri**: El, yüz, bulanıklık sorunları için otomatik negatif prompt

---

## Teknik Özellikler

### Frontend
- **React 18.3** - Modern UI framework
- **TypeScript 5.6** - Tip güvenli kod
- **Tailwind CSS 3.4** - Utility-first CSS
- **Radix UI** - Erişilebilir bileşenler
- **Lucide React** - Modern ikonlar

### Backend
- **Python FastAPI** - Yüksek performanslı API
- **Stable Diffusion 1.5** - Görsel üretim modeli
- **PyTorch** - Derin öğrenme framework
- **Diffusers** - Hugging Face model kütüphanesi
- **SQLite** - Hafif ve güvenilir veritabanı (v3.0)

### Desteklenen Platformlar
- NVIDIA GPU (CUDA) - Önerilen
- Apple Silicon (MPS) - Desteklenir
- CPU - Yavaş ama çalışır

---

## Kurulum

### Gereksinimler
- Node.js 18+
- Python 3.10+
- NVIDIA GPU (8GB+ VRAM önerilir) veya Apple Silicon

### Frontend Kurulumu
```bash
cd visual-story-generator
npm install
npm run dev
```

### Backend Kurulumu

**Windows:**
```bash
cd backend
setup.bat
```

**Linux/macOS:**
```bash
cd backend
chmod +x setup.sh
./setup.sh
```

### Sunucuyu Başlatma
```bash
cd backend
source venv/bin/activate  # Linux/macOS
# veya
venv\Scripts\activate.bat  # Windows

python server.py
```

---

## Kullanım

1. **Hikaye Girişi**: Sol panelde Türkçe hikayenizi yazın
2. **Stil Ayarları**: İstediğiniz görsel stili seçin
3. **Analiz Et**: Sistem metni otomatik analiz eder
4. **Sahneleri İncele**: Oluşturulan sahneleri gözden geçirin
5. **Prompt Seç**: Sadık veya Yaratıcı prompt tercih edin
6. **Görsel Üret**: Backend ile görsel oluşturun

---

## Proje Yapısı

```
visual-story-generator/
├── src/
│   ├── App.tsx              # Ana React bileşeni
│   ├── main.tsx             # React giriş noktası
│   ├── index.css            # Global stiller
│   ├── types.ts             # TypeScript interface'leri
│   ├── constants.ts         # Sabitler (stiller, çözünürlükler)
│   ├── api.ts               # Backend API fonksiyonları
│   ├── utils.ts             # Yardımcı fonksiyonlar
│   ├── hooks/               # Custom React hooks
│   │   ├── index.ts         # Hook exports
│   │   └── useBackend.ts    # Backend bağlantı hook'u
│   ├── components/          # Yeniden kullanılabilir bileşenler
│   │   ├── index.ts         # Component exports
│   │   └── BackendStatusBar.tsx # Backend durum çubuğu
│   └── analyzers/           # Metin analiz modülleri
│       ├── index.ts         # Analyzer exports
│       ├── idiomPatterns.ts # Türkçe deyim/mecaz kalıpları
│       └── abstractConcepts.ts # Soyut kavram görselleştirme
├── backend/
│   ├── server.py            # FastAPI sunucusu (v3.0)
│   ├── database.py          # SQLite veritabanı yönetimi
│   ├── learning_manager.py  # Öğrenme ve optimizasyon sistemi
│   ├── emotion_analyzer.py  # Gelişmiş duygu analizi
│   ├── security.py          # Güvenlik katmanı
│   ├── requirements.txt     # Python bağımlılıkları
│   ├── setup.sh             # Linux/macOS kurulum
│   └── setup.bat            # Windows kurulum
├── public/                  # Statik dosyalar
└── dist/                    # Build çıktısı
```

---

## API Endpoints (v3.0)

| Endpoint | Method | Açıklama |
|----------|--------|----------|
| `/api/generate` | POST | Görsel üretimi başlat |
| `/api/status/{job_id}` | GET | Üretim durumunu sorgula |
| `/api/feedback` | POST | Geri bildirim gönder |
| `/api/learning/stats` | GET | Öğrenme istatistikleri |
| `/api/analyze-emotion` | POST | Duygu analizi yap |
| `/api/cleanup` | POST | Eski dosyaları temizle |
| `/generated_images/{filename}` | GET | Üretilen görseli getir |

---

## Lisans

MIT License

---

## Katkıda Bulunma

1. Fork yapın
2. Feature branch oluşturun (`git checkout -b feature/amazing-feature`)
3. Değişikliklerinizi commit edin (`git commit -m 'Add amazing feature'`)
4. Branch'i push edin (`git push origin feature/amazing-feature`)
5. Pull Request açın

---

## İletişim

Sorularınız için issue açabilirsiniz.

---

**Matrix Agent** tarafından geliştirilmiştir.
